% REVISED FOR MSSN@PURDUE 
% Date: 02/2024
% 
% Note: to use package fontspec,
% use XeLaTeX to compile

% v7: YB &JQ
% 02/21/2024, updated by Chunyi


\documentclass{article}
\usepackage{siunitx}
% \usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
%\usepackage{verbatim}
\usepackage{sansmath}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{1pt}
\usetikzlibrary{patterns}
\usepgfplotslibrary{fillbetween}

\pgfplotsset{compat=newest}

%\usepackage{fontspec}
%\setmainfont[
%BoldFont={Arial Bold},
%ItalicFont={Arial Italic},
%BoldItalicFont={Arial Bold Italic}
%]{Arial}

% # user-study-sync-overhead-context-tx-v2.txt
%\pgfplotstableread{
%0   0
%1000   0.1
%5000   0.8
%10000   0.95
%20000   1
%}{\fakedata}

\makeatletter
\pgfplotsset{
my filter/.style args={every#1between#2and#3}{%
/pgfplots/x filter/.append code={%
\ifnum\coordindex<#2%
  % Nothing
\else% Did we pass #3?
  \ifnum\coordindex>#3%
    %Nothing
  \else% Ok filter is on, don't disturb \pgfmathresult for convenience
    \pgfmathsetmacro\temp{int(mod(\coordindex,#1))}%
    \ifnum0=\temp\relax% Are we on the nth point?
      % Yes do nothing let it pass
    \else% discard it
      \let\pgfmathresult\pgfutil@empty
    \fi%
  \fi%
\fi%
}}}
\makeatother

\pgfplotsset{
    compat=newest,
    legend image code/.code={
        \draw[mark repeat=2,mark phase=2]
        plot coordinates {
            (0cm,0cm)
            (0.15cm,0cm)        %% default is (0.3cm,0cm)
            (0.3cm,0cm)         %% default is (0.6cm,0cm)
        };%
    }
}

% \definecolor{palette1}{RGB}{215,25,28}
% \definecolor{palette2}{RGB}{253,174,97}
% % \definecolor{palette3}{RGB}{255,255,191}
% \definecolor{palette3}{RGB}{208,28,139}
% \definecolor{palette4}{RGB}{184,225,134}
% % \definecolor{palette4}{RGB}{171,221,164}
% \definecolor{palette5}{RGB}{43,131,186}
% \definecolor{palette6}{RGB}{208,28,139}

% green -- blueish
% \definecolor{palette1}{RGB}{0,109,44}
% \definecolor{palette2}{RGB}{44,162,95}
% \definecolor{palette3}{RGB}{67,162,202}
% \definecolor{palette4}{RGB}{8,104,172}
% \definecolor{palette5}{RGB}{8,81,156}

\definecolor{myred}{HTML}{C00000}
\definecolor{mypurple}{HTML}{7030A0}
\definecolor{myblue}{HTML}{0070C0}
\definecolor{myblue2}{HTML}{0431FF}
\definecolor{myblue0}{HTML}{0000FF}
\definecolor{mygreen}{HTML}{00B050}
\definecolor{mygray}{HTML}{A6A6A6}

\begin{document}

\begin{tikzpicture}
\begin{axis}[
   table/col sep=comma,
    xmin    = 1,
    xmax    = 46,
    ymin    = 0,
    ymax    = 1,
    width   =  5 cm,
    height  =  2.5cm, % 5cm for 1.8in --> 3.6cm for 1.3in (5 * 1.3/1.8 = 3.6)
    %grid = both,
    scale only axis = true,
    xtick align = inside,
    tick label style={/pgf/number format/assume math mode=true},
    xtick = {},
    xticklabels = {},
    ytick = {0, 0.25, 0.5, 0.75, 1},
    yticklabels = {0, 25\%, 50\%, 75\%, 100\%},
    xticklabel style = {font=\normalsize},
    yticklabel style = {
    %font=\normalsize,
    xshift = 1.25mm,
    yshift =-0.5mm,
    },
    %xmajorgrids=true,
    ymajorgrids=true,
    %yticklabels = {,,},
    % % xticklabel pos=right,
    % xtick pos = left,
    % ytick pos = left,
    % % yticklabel pos=right,
    % % enlargelimits=0.15,
    legend style={
        at      = {(1, 1)},
       % font    = \normalsize,
        fill    = none,
        draw    = none,
        anchor  = north east,
        legend cell align   = left,
        legend columns      = 1,
        samplen = 10pt, 
    },
    ylabel={Probability (\%)},
    ylabel style={
	   %font=\normalsize,
        align=center,
        xshift= -2mm,
        yshift =-4.5mm,
    },
    xlabel={Locations},
    xtick style={draw=none},
    xlabel style={
        font=\normalsize,
        % at={(current axis.north west)},
        % rotate=-90,
        % xshift=-1ex,
        xshift = -1pt,
        yshift = 8pt,
    },
]

\addplot+[
no markers,
solid,
color       = myblue,
line width  = 1.5pt,
line cap    = round,
line join   = round,
each nth point={1},
]
table[
x = index,
y = prob_predicted,
] {onoff_location_stats_spatial_s1e3_all_locations_t_0507.csv};

% Define upper bound
\addplot+[
    name path=upper,
    no markers,
    solid,
    draw=none,
    forget plot,
]
table[
x = index,
y = prob_predict_max_margin,
] {onoff_location_stats_spatial_s1e3_all_locations_t_0507.csv};

% Define lower bound
\addplot+[
    name path=lower,
    no markers,
    solid,
    draw=none,
    forget plot,
]
table[
x = index,
y = prob_predict_min_margin,
] {onoff_location_stats_spatial_s1e3_all_locations_t_0507.csv};

% Fill area between them
\addplot [
    myred,
    opacity=0.1,
    forget plot,
] fill between[
    of=upper and lower,
];
        
\addplot[
			only marks,
			mark=*,
			mark size=1pt,
			color=myred,
%			scatter,
%    scatter/use mapped color={
%        draw=black,
%        fill=myred
%    },
    			]
			%		file {data.dat};
			table[
			x = index,
			y = run_with_onoff_ratio,
			col sep=comma,
			]
			{onoff_location_stats_spatial_s1e3_all_locations_t_0507.csv};

\legend{Predicted, Ground truth};


\end{axis}
\end{tikzpicture}

\end{document}